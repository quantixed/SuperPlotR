<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Limitations to SuperPlotR • SuperPlotR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Limitations to SuperPlotR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SuperPlotR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SuperPlotR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced.html">Advanced Usage</a></li>
    <li><a class="dropdown-item" href="../articles/flatplot.html">Making non-SuperPlots - FlatPlots</a></li>
    <li><a class="dropdown-item" href="../articles/limitations.html">Limitations to SuperPlotR</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/quantixed/SuperPlotR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Limitations to SuperPlotR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/quantixed/SuperPlotR/blob/master/vignettes/limitations.Rmd" class="external-link"><code>vignettes/limitations.Rmd</code></a></small>
      <div class="d-none name"><code>limitations.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="current-limitations">Current limitations<a class="anchor" aria-label="anchor" href="#current-limitations"></a>
</h2>
<p>There are some limitations to SuperPlotR. This vignette covers them
and offers solutions where possible.</p>
<div class="section level3">
<h3 id="facetting">Facetting<a class="anchor" aria-label="anchor" href="#facetting"></a>
</h3>
<p>Facetting is <em>partially supported</em>. In the simple scenario of
facetting by replicate, you can do this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/quantixed/SuperPlotR" class="external-link">SuperPlotR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superplot.html">superplot</a></span><span class="op">(</span><span class="va">lord_jcb</span>, <span class="st">"Speed"</span>, <span class="st">"Treatment"</span>, <span class="st">"Replicate"</span>,</span>
<span>               ylab <span class="op">=</span> <span class="st">"Speed (µm/min)"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Replicate</span><span class="op">)</span></span></code></pre></div>
<p><img src="limitations_files/figure-html/facet-1.png" width="576"></p>
<p>If we had another variable that we wished to facet by, then facetting
by this variable is possible, but with a limitation: The summary points
will remain as the replicate summary and therefore will be the same for
each facet. This may not be what you want.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">lord_jcb</span>, other <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superplot.html">superplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Speed"</span>, <span class="st">"Treatment"</span>, <span class="st">"Replicate"</span>, ylab <span class="op">=</span> <span class="st">"Speed (µm/min)"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">other</span><span class="op">)</span></span></code></pre></div>
<p><img src="limitations_files/figure-html/facet2-1.png" width="576"></p>
<p><strong>Solution:</strong> The best way to do achieve “facetting”
currently (and have the correct summary points) is to make a SuperPlot
for each variable, i.e. after filtering the data frame for A and B, and
then combine them using <a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a> or similar package.</p>
</div>
<div class="section level3">
<h3 id="conditions-and-replicates-are-categories">Conditions and Replicates are categories<a class="anchor" aria-label="anchor" href="#conditions-and-replicates-are-categories"></a>
</h3>
<p>If you have a dataset where the conditions and replicates are
numeric, SuperPlotR converts them to character for plotting. This is the
intended behaviour for a SuperPlot.</p>
<p>Currently, if your data has Conditions that are numeric, for example
time points, and these are unevenly spaced, e.g. 0, 1, 3, 9 hours; then
these will appear evenly spaced on the x-axis. This is a limitation of
the current implementation. Raise an issue if you would like this to be
changed.</p>
</div>
<div class="section level3">
<h3 id="adding-statistics">Adding statistics<a class="anchor" aria-label="anchor" href="#adding-statistics"></a>
</h3>
<p>Adding p-values or stars to the SuperPlot is currently not supported
due to the number of different ways that users may wish to add them.
However, it is possible to add them manually to the SuperPlot object
after it has been generated.</p>
<p>SuperPlotR will do statistical testing for you (in a simple way) but
is turned off by default. You can turn it on by setting
<code>stats = TRUE</code> in your call to <code><a href="../reference/superplot.html">superplot()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superplot.html">superplot</a></span><span class="op">(</span><span class="va">lord_jcb</span>, <span class="st">"Speed"</span>, <span class="st">"Treatment"</span>, <span class="st">"Replicate"</span>, stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Performing t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  x and y</span></span>
<span><span class="co">#&gt; t = 1.2907, df = 3.8128, p-value = 0.2695</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -11.91888  31.89283</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x mean of y </span></span>
<span><span class="co">#&gt;  31.58355  21.59657</span></span></code></pre></div>
<p>Four types of statistical tests are available: t-test, Wilcoxon rank
sum test, ANOVA and Kruskal-Wallis test. Select between these options by
setting <code>stats_test</code> to one of the following:
<code>"para_unpaired"</code> (default), <code>"para_paired"</code>,
<code>"nonpara_unpaired"</code> or <code>"nonpara_paired"</code>.</p>
<p>If the number of conditions is two, these options result in:</p>
<ul>
<li>
<code>"para_unpaired"</code>: t-test</li>
<li>
<code>"para_paired"</code>: paired t-test</li>
<li>
<code>"nonpara_unpaired"</code>: Wilcoxon rank sum test a.k.a
Mann-Whitney U test</li>
<li>
<code>"nonpara_paired"</code>: Wilcoxon signed rank test</li>
</ul>
<p>If the number of conditions is greater than two, these options result
in:</p>
<ul>
<li>
<code>"para_unpaired"</code>: ANOVA followed by Tukey’s HSD
test</li>
<li>
<code>"para_paired"</code>: Repeated measures ANOVA</li>
<li>
<code>"nonpara_unpaired"</code>: Kruskal-Wallis test</li>
<li>
<code>"nonpara_paired"</code>: direction to perform a Friedman
test</li>
</ul>
<p>Returning to the example data, in the Lord et al. paper they perform
a paired t-test on the data. We can do this in SuperPlotR by setting
<code>stats = TRUE</code> and <code>stats_test</code> to
<code>"para_paired"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superplot.html">superplot</a></span><span class="op">(</span><span class="va">lord_jcb</span>, <span class="st">"Speed"</span>, <span class="st">"Treatment"</span>, <span class="st">"Replicate"</span>, stats <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               stats_test <span class="op">=</span> <span class="st">"para_paired"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Performing t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Paired t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  x and y</span></span>
<span><span class="co">#&gt; t = 8.1741, df = 2, p-value = 0.01464</span></span>
<span><span class="co">#&gt; alternative hypothesis: true mean difference is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;   4.730053 15.243899</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean difference </span></span>
<span><span class="co">#&gt;        9.986976</span></span></code></pre></div>
<p>As a further example, we will generate some test data with four
treatments.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>meas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">9</span>, <span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">400</span><span class="op">)</span>,</span>
<span>                      cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"drug 1"</span>, <span class="st">"drug 2"</span>, <span class="st">"drug 3"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                      expt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp1"</span>,<span class="st">"exp2"</span>,<span class="st">"exp3"</span>,<span class="st">"exp4"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/superplot.html">superplot</a></span><span class="op">(</span><span class="va">example</span>, <span class="st">"meas"</span>, <span class="st">"cond"</span>, <span class="st">"expt"</span>, linking <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          stats_test <span class="op">=</span> <span class="st">"para_unpaired"</span><span class="op">)</span></span></code></pre></div>
<p><img src="limitations_files/figure-html/stats3-1.png" width="576"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stephen J Royle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
